import{c as K,m as w,T as g,E as m,j as W,k as Q,f as k,w as X,t as Y,l as Z,x as ee,U as b}from"./index-BqO2Lj1c.js";function c(e){const[t,n]=K(e);return{get:t,set:n}}function te({initialValues:e={},validateOn:t="submit",revalidateOn:n="input",validate:i}={}){const r=c([]),l=c([]),a=c(),o=c(0),d=c(!1),s=c(!1),v=c(!1),u=c(!1),f=c(!1),h=c(!1),p=c({});return{internal:{initialValues:e,validate:i,validateOn:t,revalidateOn:n,fieldNames:r,fieldArrayNames:l,element:a,submitCount:o,submitting:d,submitted:s,validating:v,touched:u,dirty:f,invalid:h,response:p,fields:{},fieldArrays:{},validators:new Set},get element(){return a.get()},get submitCount(){return o.get()},get submitting(){return d.get()},get submitted(){return s.get()},get validating(){return v.get()},get touched(){return u.get()},get dirty(){return f.get()},get invalid(){return h.get()},get response(){return p.get()}}}function be(e){const t=te(e);return[t,{Form:n=>me(w({of:t},n)),Field:n=>ve(w({of:t},n)),FieldArray:n=>he(w({of:t},n))}]}function z(e,t,n){const{checked:i,files:r,options:l,value:a,valueAsDate:o,valueAsNumber:d}=e;return g(()=>!n||n==="string"?a:n==="string[]"?l?[...l].filter(s=>s.selected&&!s.disabled).map(s=>s.value):i?[...t.value.get()||[],a]:(t.value.get()||[]).filter(s=>s!==a):n==="number"?d:n==="boolean"?i:n==="File"&&r?r[0]:n==="File[]"&&r?[...r]:n==="Date"&&o?o:t.value.get())}function V(e){return[...Object.values(e.internal.fields),...Object.values(e.internal.fieldArrays)]}function F(e,t){return e.internal.fieldArrays[t]}function ne(e,t){return+t.replace(`${e}.`,"").split(".")[0]}function _(e,t){q(e,!1).forEach(n=>{const i=g(F(e,n).items.get).length-1;t.filter(r=>r.startsWith(`${n}.`)&&ne(n,r)>i).forEach(r=>{t.splice(t.indexOf(r),1)})})}function q(e,t=!0){const n=[...g(e.internal.fieldArrayNames.get)];return t&&_(e,n),n}function se(e,t=!0){const n=[...g(e.internal.fieldNames.get)];return t&&_(e,n),n}function N(e,t){return e.internal.fields[t]}function C(e,t,n){return g(()=>{const i=se(e,n),r=q(e,n);return typeof t=="string"||Array.isArray(t)?(typeof t=="string"?[t]:t).reduce((l,a)=>{const[o,d]=l;return r.includes(a)?(r.forEach(s=>{s.startsWith(a)&&d.add(s)}),i.forEach(s=>{s.startsWith(a)&&o.add(s)})):o.add(a),l},[new Set,new Set]).map(l=>[...l]):[i,r]})}function T(e,t){return(typeof e!="string"&&!Array.isArray(e)?e:t)||{}}function O(e,t){return e.split(".").reduce((n,i)=>n?.[i],t)}let ie=0;function I(){return ie++}function re(e,t){const n=i=>i instanceof Blob?i.size:i;return Array.isArray(e)&&Array.isArray(t)?e.map(n).join()!==t.map(n).join():e instanceof Date&&t instanceof Date?e.getTime()!==t.getTime():Number.isNaN(e)&&Number.isNaN(t)?!1:e!==t}function ae(e,t){g(()=>e.internal.dirty.set(t||V(e).some(n=>n.active.get()&&n.dirty.get())))}function le(e,t){g(()=>{const n=re(t.startValue.get(),t.value.get());n!==t.dirty.get()&&m(()=>{t.dirty.set(n),ae(e,n)})})}function oe(e,t,n,{on:i,shouldFocus:r=!1}){g(()=>{const l=t.validateOn??e.internal.validateOn,a=t.revalidateOn??e.internal.revalidateOn;i.includes((l==="submit"?e.internal.submitted.get():t.error.get())?a:l)&&G(e,n,{shouldFocus:r})})}function D(e,t,n,i,r,l){m(()=>{t.value.set(a=>t.transform.reduce((o,d)=>d(o,i),l??a)),t.touched.set(!0),e.internal.touched.set(!0),le(e,t),oe(e,t,n,{on:r})})}function ue(e,t){if(!F(e,t)){const n=O(t,e.internal.initialValues)?.map(()=>I())||[],i=c(n),r=c(n),l=c(n),a=c(""),o=c(!1),d=c(!1),s=c(!1);e.internal.fieldArrays[t]={initialItems:i,startItems:r,items:l,error:a,active:o,touched:d,dirty:s,validate:[],validateOn:void 0,revalidateOn:void 0,consumers:new Set},e.internal.fieldArrayNames.set(v=>[...v,t])}return F(e,t)}function ce(e,t){if(!N(e,t)){const n=O(t,e.internal.initialValues),i=c([]),r=c(n),l=c(n),a=c(n),o=c(""),d=c(!1),s=c(!1),v=c(!1);e.internal.fields[t]={elements:i,initialValue:r,startValue:l,value:a,error:o,active:d,touched:s,dirty:v,validate:[],validateOn:void 0,revalidateOn:void 0,transform:[],consumers:new Set},e.internal.fieldNames.set(u=>[...u,t])}return N(e,t)}function de(e,t,{shouldActive:n=!0}){const i=Object.entries(t).reduce((r,[l,a])=>([N(e,l),F(e,l)].every(o=>!o||n&&!g(o.active.get))&&r.push(a),r),[]).join(" ");i&&e.internal.response.set({status:"error",message:i})}function B(e,t){g(()=>{e.internal.invalid.set(t||V(e).some(n=>n.active.get()&&n.error.get()))})}function P(e){let t=!1,n=!1,i=!1;g(()=>{for(const r of V(e))if(r.active.get()&&(r.touched.get()&&(t=!0),r.dirty.get()&&(n=!0),r.error.get()&&(i=!0)),t&&n&&i)break}),m(()=>{e.internal.touched.set(t),e.internal.dirty.set(n),e.internal.invalid.set(i)})}function M(e,t){g(()=>N(e,t)?.elements.get()[0]?.focus())}function fe(e,t,n,{shouldActive:i=!0,shouldTouched:r=!1,shouldDirty:l=!1,shouldFocus:a=!!n}={}){m(()=>{g(()=>{for(const o of[N(e,t),F(e,t)])o&&(!i||o.active.get())&&(!r||o.touched.get())&&(!l||o.dirty.get())&&(o.error.set(n),n&&"value"in o&&a&&M(e,t))}),B(e,!!n)})}function L(e,t,n){const[i,r]=C(e,t),{shouldActive:l=!0,shouldTouched:a=!1,shouldDirty:o=!1,shouldValid:d=!1}=T(t,n);return typeof t!="string"&&!Array.isArray(t)?e.internal.fieldNames.get():r.forEach(s=>F(e,s).items.get()),i.reduce((s,v)=>{const u=N(e,v);return(!l||u.active.get())&&(!a||u.touched.get())&&(!o||u.dirty.get())&&(!d||!u.error.get())&&(typeof t=="string"?v.replace(`${t}.`,""):v).split(".").reduce((f,h,p,A)=>f[h]=p===A.length-1?u.value.get():typeof f[h]=="object"&&f[h]||(isNaN(+A[p+1])?{}:[]),s),s},typeof t=="string"?[]:{})}function ge(e,t,n){const[i,r]=C(e,t,!1),l=typeof t=="string"&&i.length===1,a=!l&&!Array.isArray(t),o=T(t,n),{initialValue:d,initialValues:s,keepResponse:v=!1,keepSubmitCount:u=!1,keepSubmitted:f=!1,keepValues:h=!1,keepDirtyValues:p=!1,keepItems:A=!1,keepDirtyItems:J=!1,keepErrors:$=!1,keepTouched:j=!1,keepDirty:R=!1}=o;m(()=>g(()=>{i.forEach(E=>{const y=N(e,E);(l?"initialValue"in o:s)&&y.initialValue.set(()=>l?d:O(E,s));const S=p&&y.dirty.get();!h&&!S&&(y.startValue.set(y.initialValue.get),y.value.set(y.initialValue.get),y.elements.get().forEach(x=>{x.type==="file"&&(x.value="")})),j||y.touched.set(!1),!R&&!h&&!S&&y.dirty.set(!1),$||y.error.set("")}),r.forEach(E=>{const y=F(e,E),S=J&&y.dirty.get();!A&&!S&&(s&&y.initialItems.set(O(E,s)?.map(()=>I())||[]),y.startItems.set([...y.initialItems.get()]),y.items.set([...y.initialItems.get()])),j||y.touched.set(!1),!R&&!A&&!S&&y.dirty.set(!1),$||y.error.set("")}),a&&(v||e.internal.response.set({}),u||e.internal.submitCount.set(0),f||e.internal.submitted.set(!1)),P(e)}))}function ye(e,t,{duration:n}={}){e.internal.response.set(t),n&&setTimeout(()=>{g(e.internal.response.get)===t&&e.internal.response.set({})},n)}async function G(e,t,n){const[i,r]=C(e,t),{shouldActive:l=!0,shouldFocus:a=!0}=T(t,n),o=I();e.internal.validators.add(o),e.internal.validating.set(!0);const d=e.internal.validate?await e.internal.validate(g(()=>L(e,{shouldActive:l}))):{};let s=typeof t!="string"&&!Array.isArray(t)?!Object.keys(d).length:!0;const[v]=await Promise.all([Promise.all(i.map(async u=>{const f=N(e,u);if(!l||g(f.active.get)){let h;for(const A of f.validate)if(h=await A(g(f.value.get)),h)break;const p=h||d[u]||"";return p&&(s=!1),f.error.set(p),p?u:null}})),Promise.all(r.map(async u=>{const f=F(e,u);if(!l||g(f.active.get)){let h="";for(const A of f.validate)if(h=await A(g(f.items.get)),h)break;const p=h||d[u]||"";p&&(s=!1),f.error.set(p)}}))]);return m(()=>{if(de(e,d,{shouldActive:l}),a){const u=v.find(f=>f);u&&M(e,u)}B(e,!s),e.internal.validators.delete(o),e.internal.validators.size||e.internal.validating.set(!1)}),s}function H({of:e,name:t,getStore:n,validate:i,validateOn:r,revalidateOn:l,transform:a,keepActive:o=!1,keepState:d=!0}){W(()=>{const s=n();s.validate=i?Array.isArray(i)?i:[i]:[],s.validateOn=r,s.revalidateOn=l,"transform"in s&&(s.transform=a?Array.isArray(a)?a:[a]:[]);const v=I();s.consumers.add(v),g(s.active.get)||m(()=>{s.active.set(!0),P(e)}),Q(()=>setTimeout(()=>{s.consumers.delete(v),m(()=>{!o&&!s.consumers.size&&(s.active.set(!1),d?P(e):ge(e,t))}),"elements"in s&&s.elements.set(u=>u.filter(f=>f.isConnected))}))})}function ve(e){const t=k(()=>ce(e.of,e.name));return H(w({getStore:t},e)),k(()=>e.children({get name(){return e.name},get value(){return t().value.get()},get error(){return t().error.get()},get active(){return t().active.get()},get touched(){return t().touched.get()},get dirty(){return t().dirty.get()}},{get name(){return e.name},get autofocus(){return!!t().error.get()},ref(n){t().elements.set(i=>[...i,n]),W(()=>{if(n.type!=="radio"&&t().startValue.get()===void 0&&g(t().value.get)===void 0){const i=z(n,t(),e.type);t().startValue.set(()=>i),t().value.set(()=>i)}})},onInput(n){D(e.of,t(),e.name,n,["touched","input"],z(n.currentTarget,t(),e.type))},onChange(n){D(e.of,t(),e.name,n,["change"])},onBlur(n){D(e.of,t(),e.name,n,["touched","blur"])}}))}function he(e){const t=k(()=>ue(e.of,e.name));return H(w({getStore:t},e)),k(()=>e.children({get name(){return e.name},get items(){return t().items.get()},get error(){return t().error.get()},get active(){return t().active.get()},get touched(){return t().touched.get()},get dirty(){return t().dirty.get()}}))}class U extends Error{name="FormError";errors;constructor(t,n){super(typeof t=="string"?t:""),this.errors=typeof t=="string"?n||{}:t}}var pe=Y("<form novalidate>");function me(e){const[,t,n]=X(e,["of"],["keepResponse","shouldActive","shouldTouched","shouldDirty","shouldFocus"]);return(()=>{var i=pe(),r=e.of.internal.element.set;return typeof r=="function"?Z(r,i):e.of.internal.element.set=i,ee(i,w(n,{onSubmit:async l=>{l.preventDefault();const{of:a,onSubmit:o,responseDuration:d}=e;m(()=>{t.keepResponse||a.internal.response.set({}),a.internal.submitCount.set(s=>s+1),a.internal.submitted.set(!0),a.internal.submitting.set(!0)});try{await G(a,t)&&await o?.(L(a,t),l)}catch(s){m(()=>{s instanceof U&&Object.entries(s.errors).forEach(([v,u])=>{u&&fe(a,v,u,{...t,shouldFocus:!1})}),(!(s instanceof U)||s.message)&&ye(a,{status:"error",message:s?.message||"An unknown error has occurred."},{duration:d})})}finally{a.internal.submitting.set(!1)}}}),!1,!1),i})()}const Fe={async login(e){return(await b.post("/auth/login",e)).data},async register(e){return(await b.post("/auth/register",e)).data},async checkUsername(e){return(await b.get(`/auth/check-username?username=${e}`)).data},async deletePendingMember(e){return(await b.delete(`/auth/delete-pending-member?email=${e}`)).data},async resendOtp(e){return(await b.put("/auth/resend-otp",e)).data},async verifyOtp(e){return(await b.post("/auth/verify-otp",e)).data},async resetPassword(e){return(await b.post("/auth/reset-password",e)).data},async changePassword(e){return(await b.put("/auth/change-password",e)).data}};export{Fe as a,be as c};
