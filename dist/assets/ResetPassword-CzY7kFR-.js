import{c as y,u as J,I as K,a as O,p as Q,o as U,t as c,s as V,i as o,e as p,b as r,X as a,d as i,f as h,m as x,h as j,n as W}from"./index-Dgi8wYgQ.js";import{F as _,S as Y,v as I,r as Z,f as ee}from"./Spinner-C5fwcexh.js";import{c as re,a as L}from"./authService-BoypurrR.js";import{l as te}from"./logo_cashierly-DxzG-zww.js";var se=c('<div class="max-w-md w-full space-y-4"><div class=text-center><img alt="Cashierly Logo"class="mx-auto h-48">'),ae=c("<div><h2></h2><p></p><button>"),le=c("<h2>"),oe=c("<p>"),ne=c("<div class=space-y-5>"),ie=c('<button type=submit><div class="flex items-center gap-2">'),ce=c('<div class="text-center mt-4"><p> <a href=/auth/login>'),de=c("<input type=hidden name=email>"),ue=c("<input type=hidden name=token>");const ve=()=>{const[d,k]=y(!1),[D,N]=y(!1),[u,R]=y("email"),[q,A]=y(null),[b,H]=y(null),C=J(),[v]=K(),{isDarkMode:m}=O(),[P]=Q();U(()=>{P.token&&(R("password"),A(P.email),H(P.token))});const[we,{Form:X,Field:f}]=re({validate:n=>u()==="password"?I(Z)(n):I(ee)(n)}),z=async n=>{k(!0);try{if(u()==="email"){const w=await L.resetPassword(n);j.success(w?.success),N(!0)}else if(u()==="password"){const w={token:b(),newPassword:n.password},$=await L.changePassword(w);j.success($?.success),C("/auth/login")}}catch(w){console.error("Password reset request failed:",w)}finally{k(!1)}};return(()=>{var n=se(),w=n.firstChild,$=w.firstChild;return V($,"src",te),o(n,(()=>{var G=p(()=>!!D());return()=>G()?(()=>{var t=ae(),s=t.firstChild,e=s.nextSibling,l=e.nextSibling;return o(s,r(a,{key:"resetPassword.checkEmail"})),o(e,r(a,{key:"resetPassword.emailSent"})),l.$$click=()=>C("/auth/login"),i(l,T),o(l,r(a,{key:"resetPassword.returnToLogin"})),h(g=>{var S=B(m()),F=M(m()),E=`text-center ${m()?"text-gray-300":"text-gray-600"} mb-4`;return S!==g.e&&i(t,g.e=S),F!==g.t&&i(s,g.t=F),E!==g.a&&i(e,g.a=E),g},{e:void 0,t:void 0,a:void 0}),t})():r(X,{onSubmit:z,get class(){return B(m())},get children(){return[(()=>{var t=le();return o(t,(()=>{var s=p(()=>u()==="email");return()=>s()?r(a,{key:"resetPassword.title"}):r(a,{key:"resetPassword.resetTitle"})})()),h(()=>i(t,M(m()))),t})(),(()=>{var t=oe();return o(t,(()=>{var s=p(()=>u()==="email");return()=>s()?r(a,{key:"resetPassword.enterEmailInfo"}):r(a,{key:"resetPassword.enterPasswordInfo"})})()),h(()=>i(t,`text-center ${m()?"text-gray-300":"text-gray-600"} mb-4`)),t})(),(()=>{var t=ne();return o(t,(()=>{var s=p(()=>u()==="email");return()=>s()?r(f,{name:"email",children:(e,l)=>r(_,x(l,{get value(){return e.value},get error(){return e.error},get label(){return r(a,{key:"resetPassword.email"})},type:"text",get placeholder(){return v("resetPassword.emailPlaceholder")}}))}):[r(f,{name:"password",children:(e,l)=>r(_,x(l,{get value(){return e.value},get error(){return e.error},get label(){return r(a,{key:"resetPassword.newPassword"})},type:"password",get placeholder(){return v("resetPassword.newPasswordPlaceholder")}}))}),r(f,{name:"confirmPassword",children:(e,l)=>r(_,x(l,{get value(){return e.value},get error(){return e.error},get label(){return r(a,{key:"resetPassword.confirmPassword"})},type:"password",get placeholder(){return v("resetPassword.confirmPasswordPlaceholder")}}))}),(()=>{var e=de();return h(()=>e.value=q()),e})(),(()=>{var e=ue();return h(()=>e.value=b()),e})()]})()),t})(),(()=>{var t=ie(),s=t.firstChild;return i(t,T),o(s,(()=>{var e=p(()=>!!d());return()=>e()&&r(Y,{})})(),null),o(s,(()=>{var e=p(()=>!!d());return()=>e()?r(a,{key:"resetPassword.sending"}):p(()=>u()==="email")()?r(a,{key:"resetPassword.resetButton"}):r(a,{key:"resetPassword.updateButton"})})(),null),h(()=>t.disabled=d()),t})(),(()=>{var t=ce(),s=t.firstChild,e=s.firstChild,l=e.nextSibling;return o(s,r(a,{key:"resetPassword.rememberPassword"}),e),i(l,me),o(l,r(a,{key:"resetPassword.signInHere"})),h(()=>i(s,`text-sm ${m()?"text-gray-300":"text-gray-600"}`)),t})()]}})})(),null),n})()},M=d=>`text-2xl font-bold ${d?"text-gray-100":"text-gray-900"} text-center`,B=d=>["mt-4 space-y-6",d?"bg-gray-800 text-white":"bg-white","p-8","rounded-2xl shadow-lg"].join(" "),T=["w-full flex justify-center","py-3 px-4 rounded-xl","shadow-sm text-sm font-medium","text-white btn-primary"].join(" "),me=["font-medium","text-blue-600","hover:text-blue-500"].join(" ");W(["click"]);export{ve as default};
